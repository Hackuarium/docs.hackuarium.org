<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.6">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Hackuarium open-hardware documentation Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Hackuarium open-hardware documentation Blog Atom Feed"><title data-react-helmet="true">EC | Hackuarium open-hardware documentation</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://docs.hackuarium.org/docs/phmeter/tests/ec/README"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="EC | Hackuarium open-hardware documentation"><meta data-react-helmet="true" name="description" content="For the EC reading, we are checking all the hardware steps to be sure that the signal pass correctly."><meta data-react-helmet="true" property="og:description" content="For the EC reading, we are checking all the hardware steps to be sure that the signal pass correctly."><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://docs.hackuarium.org/docs/phmeter/tests/ec/README"><link data-react-helmet="true" rel="alternate" href="https://docs.hackuarium.org/docs/phmeter/tests/ec/README" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://docs.hackuarium.org/docs/phmeter/tests/ec/README" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.d6449401.css">
<link rel="preload" href="/assets/js/runtime~main.2e123f76.js" as="script">
<link rel="preload" href="/assets/js/main.62135c29.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/logo.svg" alt="Hackuarium logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/logo.svg" alt="Hackuarium logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">Hackuarium</b></a><a class="navbar__item navbar__link navbar__link--active" href="/docs/intro">Tutorial</a><a class="navbar__item navbar__link" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="react-toggle toggle_3Zt9 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">ðŸŒž</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div><div class="navbar__search searchBarContainer_MM2z"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_s5VG searchBarLoadingRing_2jQk"><div></div><div></div><div></div><div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button class="clean-btn backToTopButton_35hR" type="button"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/docs/intro">Hackuarium documentation</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Simple-Spectro</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Beemos</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Bioreactor</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Incubator</a></li><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">pH Meter</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/phmeter">Introduction</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Platformio</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Making</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Using</a></li><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#" tabindex="0">Tests</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/phmeter/tests/battery/README">Battery</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/phmeter/tests/stability/README">Stability</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/docs/phmeter/tests/ph/README">pH</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/phmeter/tests/ec/README">EC</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Writing documentation</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Programming</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">threadino</a></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD theme-doc-toc-mobile tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>EC</h1></header><p>For the EC reading, we are checking all the hardware steps to be sure that the signal pass correctly.</p><p><img alt="pHMeter and EC probe" src="/assets/images/phMeter_pH_and_EC_probe-425ce632793cd50bd858393d69ab1713.jpg"></p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="signal-generator"></a>Signal generator<a class="hash-link" href="#signal-generator" title="Direct link to heading">#</a></h2><p>This first test is in the outoput pin for the signal generator, you must to put the oscilloscope probe in the pin 7 for U8 IC like the next picture:</p><p><img alt="EC test signal generator" src="/assets/images/ec_hw_test_signal_generator-a7fd9975bf6710f11066c4f392a9668a.png"></p><p>If everything runs well, you have to obtain a signal plot like this:</p><p><img alt="EC signal generator" src="/assets/images/signal_generator-85014fa2578bc4fae0e1294b82258d10.bmp"></p><p>The ideal values for this part of the circuit need to be:</p><table><thead><tr><th align="left">Measurement</th><th>Value</th></tr></thead><tbody><tr><td align="left">Voltage Max</td><td>3.3 V</td></tr><tr><td align="left">Voltage Min</td><td>-3.3 V</td></tr><tr><td align="left">Frequency</td><td>1.76 kHz</td></tr></tbody></table><p>The experimental results are very similiar to the plot 1 in the figure:</p><p><img alt="EC signal generator" src="/assets/images/signal_generator_pp-3a0fc2d53392355d2deebd05e757e3e4.bmp"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="excitation-signal"></a>Excitation signal<a class="hash-link" href="#excitation-signal" title="Direct link to heading">#</a></h3><p>Once you have a correct signal generation, the next step is check if you have the correct reduction voltage to supply the EC probe. So, you need to check the center pin for the BNC connector in the EC circuit.</p><p><img alt="EC excitation" src="/assets/images/ec_hw_test_excitation-a5c7d31616304efd33a8b45eddc7e0b4.png"></p><p>Now, you must obtain this results:</p><table><thead><tr><th align="left">Measurement</th><th>Value</th></tr></thead><tbody><tr><td align="left">Voltage Max</td><td>129 mV</td></tr><tr><td align="left">Voltage Min</td><td>-129 mV</td></tr><tr><td align="left">Frequency</td><td>1.76 kHz</td></tr></tbody></table><p>You can see plot 2 signal result in this figure:</p><p><img alt="EC excitation plot" src="/assets/images/excitation_pp-43de1976666c5169792fa241fa8977af.bmp"></p><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p>You can see the differnce between the magnitude of the voltage between the signal square generation and excitation in this figure:</p><ol><li>Considering the difference between the gain in each channel. <strong>Channel 1</strong> has 2.00 V for every square in the horizontal axis (white dots behind yellow and blue plots), while <strong>Channel 2</strong> has 200 mV instead.</li><li>Due to design for OPA (negative feedback), the excitation signal has the negative part for the signal generation, but this doesn&#x27;t have any important consequence later.</li></ol><p><img alt="EC signal square generation vs EC excitation" src="/assets/images/signal_generator_vs_excitation-0f17f11ae76b123e77137209f3d5c484.bmp"></p></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="adquiring-ec-signal"></a>Adquiring EC signal<a class="hash-link" href="#adquiring-ec-signal" title="Direct link to heading">#</a></h2><p>The principal measurement in this case was made using KCI (potassium chloride) mixed with destilated water in proportion 1:1 for 50 ml. In this case, you need to read in 1 of the 4 external pins in the BNC connector for EC (see Figure).</p><p><img alt="EC probe response" src="/assets/images/ec_hw_test_signal_response-3a17433dd6cf8537f8a26c7b878dbe8a.png"></p><p>The response in the oscilloscope must to be similar to this:</p><p><img alt="EC response" src="/assets/images/ec_probe_response-750fa502ee8606d3b5bfb1c045b91274.bmp"></p><p>You can see the big difference compare to the excitation. Now, you have volage peaks with the same frequency to the signal excitation not square signal. This is due to the fast exponential behavior in the transfer of ions from the solution. In the same way, in the later stages of the conditioning circuit, a change in the signal will be obtained, so that it&#x27;s easily interpreted by the ADC.</p><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p>Compare the excitation signal (<strong>Channel 2</strong>) versus signal response (<strong>Channel 1</strong>):</p><p><img alt="EC signal excitation vs signal response" src="/assets/images/excitation_vs_response-7e2069c1207b54bb7c276c8bd048fd02.bmp"></p></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_31ik" id="first-stage-of-conditioning"></a>First stage of conditioning<a class="hash-link" href="#first-stage-of-conditioning" title="Direct link to heading">#</a></h3><p>After check the correct response for the EC probe, you need to check the diode + OPA configuration.</p><p><img alt="EC diodes signal" src="/assets/images/ec_hw_test_diode_response-8a3c425327ab2e25f49660d0a1adcb32.png"></p><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</h5></div><div class="admonition-content"><p>You can put the oscilloscope probe near to D1 pin or D2 pin, the signal must to be the same.</p></div></div><p>In this case, you will be obtain a signal similar to a sawtooth with negative ramp and positive and negative peaks:</p><p><img alt="EC conditioning in first stage" src="/assets/images/response_diodes-9def3dd2b30dd3188bddf6ae9c63882f.bmp"></p><p>This signal varies in amplitudes depending on the quantity of KCI + destilated water in the test.</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>This first test is only for check the answer in the EC, so the final value can change if you want to calibrate the EC.</p></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="second-stage-of-conditioning"></a>Second stage of conditioning<a class="hash-link" href="#second-stage-of-conditioning" title="Direct link to heading">#</a></h2><p>After see the sawtooth, you are ready to test the last stage for the analog conditioning.</p><p><img alt="EC response ADC" src="/assets/images/ec_hw_test_response_to_ADC-784ade52f464483d5535adcf15117d2c.png"></p><p>In this stage, you must to observe only a sawtooth with negative peaks and positive peaks.</p><p>This stage converts the negative values to positive and smooths the signal:</p><p><img alt="EC response to ADC" src="/assets/images/response_to_ADC-0d2b1e01b7c12efe1c5701606725fa90.bmp"></p><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p>Compare the initial response (<strong>Channel 1</strong>) versus second stage of conditioning (<strong>Channel 2</strong>).</p><p><img alt="EC response vs first stage of conditioning" src="/assets/images/response_vs_to_ADC-7a4bef2e6d9981db26d99fe26fdaabfc.bmp"></p></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_31ik" id="adc-conversion"></a>ADC conversion<a class="hash-link" href="#adc-conversion" title="Direct link to heading">#</a></h2><p>Once you have verify all conversion stages, the final steps is check the serial monitor with the ADC values from the microcontroller. So, if you have everthing ok, you will be obtain raw values likes this:</p><p><img alt="EC raw values" src="/assets/images/ec_raw-18d48c30136417c489f7944764064d67.svg"></p><div class="admonition admonition-caution alert alert--warning"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</h5></div><div class="admonition-content"><p>Be sure that  the ADC response is stable, in other case, you need to check the previous stages or considering to replace the capacitor <strong>C35</strong> in the board for a new with the 220 nF or 22 nF value.</p></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/hackuarium/docs.hackuarium.org/edit/main/docs/40_phmeter/40_tests/40_ec/README.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_13-_"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/phmeter/tests/ph/README"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« pH</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/writing-documentation/intro"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Tutorial Intro Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#signal-generator" class="table-of-contents__link">Signal generator</a><ul><li><a href="#excitation-signal" class="table-of-contents__link">Excitation signal</a></li></ul></li><li><a href="#adquiring-ec-signal" class="table-of-contents__link">Adquiring EC signal</a><ul><li><a href="#first-stage-of-conditioning" class="table-of-contents__link">First stage of conditioning</a></li></ul></li><li><a href="#second-stage-of-conditioning" class="table-of-contents__link">Second stage of conditioning</a></li><li><a href="#adc-conversion" class="table-of-contents__link">ADC conversion</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2022 Hackuarium contributors. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.2e123f76.js"></script>
<script src="/assets/js/main.62135c29.js"></script>
</body>
</html>